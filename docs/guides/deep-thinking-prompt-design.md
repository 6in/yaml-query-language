# 深い考察を引き出すプロンプト設計ガイド

## 1. 概要

本ドキュメントは、AIに深い考察を引き出すためのプロンプト設計方法をまとめます。今回のスキーマインポート機能の利用用途考察を例に、効果的なプロンプトの構造を説明します。

## 2. 今回の考察の特徴

### 2.1 考察の流れ

1. **問題提起の明確化**: 「スキーマインポートはどこに使うのか？」
2. **既存用途の整理**: 2つの既存用途を明確に整理
3. **体系的探索**: カテゴリ別に可能性を探索（15以上の用途を発見）
4. **実装優先度の考察**: 高/中/低優先度に分類
5. **実装方針の考察**: 用途別の実装方法を検討

### 2.2 考察の深さ

- **表面的でない**: 「こういう用途がある」だけでなく、「なぜ必要か」「どう実装するか」まで考察
- **体系的**: カテゴリ分けして漏れなく探索
- **実装を意識**: 抽象的な話だけでなく、具体的な実装方針まで考察
- **優先度を考慮**: 全てを実装するのではなく、優先度を明確化

## 3. 効果的なプロンプトの構造

### 3.1 基本構造

```
1. 問題提起（明確な質問）
2. 既存情報の整理（現状の把握）
3. 探索の指示（体系的に考える）
4. 考察の深さの指定（どこまで考えるか）
5. 出力形式の指定（どうまとめるか）
```

### 3.2 プロンプトテンプレート

```
# 深い考察プロンプトテンプレート

## 問題提起
[具体的な問題や疑問を明確に記述]

## 既存情報の整理
- 現在想定されている用途: [既存の用途を列挙]
- 現状の理解: [現状の理解を記述]

## 探索の指示
以下の観点から、体系的に可能性を探索してください：
1. [観点1]: [具体的な探索内容]
2. [観点2]: [具体的な探索内容]
3. [観点3]: [具体的な探索内容]

## 考察の深さ
各用途について、以下を考察してください：
- **目的**: 何のために使うのか
- **利用シーン**: 具体的な使用場面
- **実装方針**: どう実装するか（複数案があれば比較）
- **価値**: なぜ必要か、どんなメリットがあるか
- **優先度**: 実装優先度（高/中/低）とその理由

## 出力形式
以下の形式でまとめてください：
1. 既存用途の整理
2. 新たに発見した用途（カテゴリ別）
3. 実装優先度の考察
4. 実装方針の考察
5. 結論・次のステップ
```

## 4. 具体例: スキーマインポート機能の考察

### 4.1 実際に使用したプロンプト（再構成）

```
スキーマインポート機能について、深く考察してください。

## 問題提起
スキーマインポート機能は、現在以下の2つの用途が想定されています：
1. SQL生成時のサポート情報（型チェック、バリデーション）
2. AI解析用のスキーマ埋め込み

しかし、スキーマ情報はこれ以外にも様々な用途で活用できる可能性があります。

## 探索の指示
以下の観点から、体系的に可能性を探索してください：

1. **実行時（YQL→SQL変換時）**
   - SQL生成以外に何ができるか？
   - パーサー/ジェネレーターが利用できる情報は？

2. **開発時（開発支援）**
   - ドキュメント生成、コード生成、テスト支援など
   - 開発効率を向上させる用途は？

3. **分析・最適化**
   - パフォーマンス分析、最適化提案など
   - クエリやスキーマの分析用途は？

4. **品質・セキュリティ**
   - セキュリティチェック、データ品質チェックなど
   - リスク管理の用途は？

5. **管理・運用**
   - バージョン管理、差分検出、マイグレーション支援など
   - 運用効率を向上させる用途は？

## 考察の深さ
各用途について、以下を考察してください：
- **目的**: 何のために使うのか
- **利用シーン**: 具体的な使用場面
- **実装方針**: どう実装するか（参照形式/埋め込み形式など）
- **価値**: なぜ必要か、どんなメリットがあるか
- **優先度**: 実装優先度（高/中/低）とその理由

## 出力形式
以下の形式でまとめてください：
1. 既存の2つの用途の整理（目的、特徴、実装方針）
2. 新たに発見した用途（カテゴリ別に整理）
3. 利用用途の分類（実行時/開発時など）
4. 実装優先度の考察（高/中/低）
5. 実装方針の考察（用途別の実装方法）
6. 結論・次のステップ
```

## 5. プロンプト設計のポイント

### 5.1 問題提起を明確にする

**悪い例**:
```
スキーマインポートについて考えて。
```

**良い例**:
```
スキーマインポート機能は、現在2つの用途が想定されていますが、
これ以外にも様々な用途で活用できる可能性があります。
体系的に探索してください。
```

### 5.2 探索の観点を提示する

**悪い例**:
```
他にどんな用途があるか考えて。
```

**良い例**:
```
以下の観点から、体系的に可能性を探索してください：
1. 実行時（YQL→SQL変換時）の用途
2. 開発時（開発支援）の用途
3. 分析・最適化の用途
4. 品質・セキュリティの用途
5. 管理・運用の用途
```

### 5.3 考察の深さを指定する

**悪い例**:
```
各用途について考えて。
```

**良い例**:
```
各用途について、以下を考察してください：
- 目的: 何のために使うのか
- 利用シーン: 具体的な使用場面
- 実装方針: どう実装するか
- 価値: なぜ必要か
- 優先度: 実装優先度とその理由
```

### 5.4 出力形式を指定する

**悪い例**:
```
まとめて。
```

**良い例**:
```
以下の形式でまとめてください：
1. 既存用途の整理
2. 新たに発見した用途（カテゴリ別）
3. 実装優先度の考察
4. 実装方針の考察
5. 結論・次のステップ
```

## 6. `/deep-think`コマンドの設計案

### 6.1 基本設計

```
/deep-think [トピック] [探索観点] [考察の深さ]
```

### 6.2 具体例

```
/deep-think "スキーマインポート機能の利用用途" \
  --categories "実行時,開発時,分析,品質,管理" \
  --depth "目的,利用シーン,実装方針,価値,優先度" \
  --output "既存整理,新規用途,優先度,実装方針,結論"
```

### 6.3 より簡潔な形式

```
/deep-think "スキーマインポート機能の利用用途"
```

→ デフォルトの探索観点と考察の深さを使用

### 6.4 カスタマイズ可能な形式

```
/deep-think "スキーマインポート機能の利用用途" \
  --explore "実行時,開発時,分析,品質,管理" \
  --analyze "目的,利用シーン,実装方針,価値,優先度" \
  --format "markdown" \
  --output "docs/analysis/"
```

## 7. プロンプトのバリエーション

### 7.1 比較検討型

```
[トピック]について、[案A]と[案B]を比較検討してください。

## 比較観点
1. [観点1]: [具体的な比較内容]
2. [観点2]: [具体的な比較内容]
3. [観点3]: [具体的な比較内容]

## 考察の深さ
各観点について、以下を考察してください：
- 案Aの特徴: [特徴]
- 案Bの特徴: [特徴]
- 比較結果: [どちらが優れているか、なぜか]
- 推奨: [推奨案とその理由]

## 出力形式
以下の形式でまとめてください：
1. 各案の整理
2. 観点別の比較
3. 総合評価
4. 推奨案とその理由
```

### 7.2 問題解決型

```
[問題]について、深く考察してください。

## 問題の整理
- 現状: [現在の状況]
- 課題: [何が問題か]
- 制約: [制約条件]

## 解決策の探索
以下の観点から、体系的に解決策を探索してください：
1. [観点1]: [具体的な探索内容]
2. [観点2]: [具体的な探索内容]

## 考察の深さ
各解決策について、以下を考察してください：
- 解決策の内容: [具体的な解決方法]
- 実装方法: [どう実装するか]
- メリット: [どんなメリットがあるか]
- デメリット: [どんなデメリットがあるか]
- 実装優先度: [優先度とその理由]

## 出力形式
以下の形式でまとめてください：
1. 問題の整理
2. 解決策の探索（カテゴリ別）
3. 解決策の比較
4. 推奨解決策とその理由
5. 実装計画
```

### 7.3 設計検討型

```
[機能]の設計について、深く考察してください。

## 設計要件
- 要件1: [具体的な要件]
- 要件2: [具体的な要件]
- 制約: [制約条件]

## 設計案の探索
以下の観点から、体系的に設計案を探索してください：
1. [観点1]: [具体的な探索内容]
2. [観点2]: [具体的な探索内容]

## 考察の深さ
各設計案について、以下を考察してください：
- 設計案の内容: [具体的な設計]
- 実装方法: [どう実装するか]
- メリット: [どんなメリットがあるか]
- デメリット: [どんなデメリットがあるか]
- 実装複雑度: [実装の難易度]
- 推奨度: [推奨度とその理由]

## 出力形式
以下の形式でまとめてください：
1. 設計要件の整理
2. 設計案の探索（カテゴリ別）
3. 設計案の比較
4. 推奨設計案とその理由
5. 実装方針
```

## 8. 実践的な使い方

### 8.1 段階的な深掘り

**第1段階: 広く探索**
```
[トピック]について、可能な用途を広く探索してください。
```

**第2段階: 深く考察**
```
[トピック]について、[第1段階で発見した用途]を深く考察してください。
各用途について、目的、利用シーン、実装方針、価値、優先度を考察してください。
```

**第3段階: 実装方針の検討**
```
[トピック]について、[第2段階で優先度が高い用途]の実装方針を詳しく検討してください。
複数の実装案を比較し、推奨案を提示してください。
```

### 8.2 反復的な改善

1. **初回**: 広く探索して可能性を洗い出す
2. **2回目**: 発見した可能性を深く考察
3. **3回目**: 実装方針を具体的に検討
4. **4回目**: 実装計画を立てる

## 9. まとめ

### 9.1 効果的なプロンプトの特徴

1. **問題提起が明確**: 何を考えたいかが明確
2. **探索観点を提示**: 体系的に探索できる
3. **考察の深さを指定**: どこまで考えるかが明確
4. **出力形式を指定**: どうまとめるかが明確

### 9.2 `/deep-think`コマンドの価値

- **一貫性**: 毎回同じ構造で深い考察ができる
- **効率性**: プロンプトを毎回書く必要がない
- **再現性**: 同じトピックでも同じ深さで考察できる
- **カスタマイズ性**: 用途に応じて調整可能

### 9.3 推奨アプローチ

1. **基本コマンド**: `/deep-think [トピック]`（デフォルト設定）
2. **カスタマイズ**: 必要に応じてオプションで調整
3. **段階的深掘り**: 複数回に分けて段階的に深掘り
4. **反復改善**: 考察結果を基に、さらに深掘り

このアプローチにより、**体系的で深い考察**を効率的に引き出すことができます。

