# 🏗️ アーキテクチャ

YQLのシステムアーキテクチャと技術設計について説明します。

## 基本フロー

```
┌─────────────────────────────────────────────────────────────────────┐
│                         YQL アーキテクチャ                           │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  [開発時]                                                           │
│    自然言語 → AI → YQL                                              │
│         ↑          ↓                                                │
│      人間理解   要件定義・仕様書                                     │
│                                                                     │
│  [実行時]                                                           │
│    YQL → パーサー → AST → ジェネレーター → SQL → データベース        │
│                      ↓                                              │
│                 型検証・最適化                                       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

## 主要コンポーネント

| コンポーネント | 役割 | ステータス |
|---------------|------|-----------|
| **YQL Parser** | YAML → AST (抽象構文木) 変換 | 🚧 開発中 |
| **Type Checker** | スキーマベースの型検証 | 📝 計画中 |
| **SQL Generator** | AST → データベース固有SQL生成 | 🚧 開発中 |
| **Schema Manager** | マルチDB対応、型定義管理 | 📝 計画中 |
| **AI Integration** | 自然言語 ↔ YQL双方向変換（開発時） | ✅ 利用可能 |

## 対応データベース

| データベース | SELECT | INSERT | UPDATE | DELETE | UPSERT |
|-------------|--------|--------|--------|--------|--------|
| PostgreSQL | ✅ | ✅ | ✅ | ✅ | ✅ |
| MySQL | ✅ | ✅ | ✅ | ✅ | ✅ |
| SQL Server | ✅ | ✅ | ✅ | ✅ | ✅ |
| Oracle | 🚧 | 🚧 | 🚧 | 🚧 | 🚧 |

## 技術スタック（予定）

| コンポーネント | 技術 | 理由 |
|---------------|------|------|
| **コア実装** | Python（MVP）、Rust（本格版） | Python: 迅速な開発、Rust: パフォーマンス |
| **UI統合** | WASM | ブラウザでリアルタイムSQL生成 |
| **IDE支援** | Language Server Protocol (LSP) | エディタ非依存 |
| **AI統合** | OpenAI/Anthropic/Google AI API | 複数プロバイダー対応 |

## 詳細ドキュメント

- [セキュリティ設計](security.md) - 多層防御アプローチ
- [マルチDB対応](multi-db.md) - SQL方言の抽象化
- [DB移行支援](db-migration.md) - YQLを中間形式とした移行

## 関連仕様書

- [specs/select.md](../../specs/select.md) - SELECT文仕様
- [specs/schema.md](../../specs/schema.md) - スキーマ定義仕様
- [specs/import.md](../../specs/import.md) - using/import機能仕様
